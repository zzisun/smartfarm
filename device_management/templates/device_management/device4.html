{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>main</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;700&display=swap" rel="stylesheet">
    <link href="//db.onlinewebfonts.com/c/d4d6e1a6527a21185217393c427a52cb?family=Segoe+UI+Semibold" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href={% static "css/default.css" %}>
    <script type="text/javascript" src={% static "js/jquery-3.5.1.min.js" %}></script>
    <script type="text/javascript" src={% static "js/main.js" %}></script>
</head>
<body>
    <!-- header -->
    <header class="header">
        <a href="javascript:;" class="back_btn  txt_medium">BACK</a>
    </header>
    <!-- //header -->
    <!-- device -->

    <div class="device_wrap footer_on">
        
        <!--
        <form action={% url 'device_management:Create_farm_info' %} method="POST">
                -->
           
        <form action={% url 'device_management:Create_farm_info' %} method="POST">
           
            {% csrf_token %}
            <div class="cont tx_c">
                <div id="get_hidden_1" class = "get_hidden" style="display: block;">
                    <h2 class="top_title re_tp10">Choose Krishian Smart farm</h2>
                    
                    <div class="scroll_box tm50">
                    
                        <ul>
                            <li class="bm10">
                                <label for="farm1" class="custom_radio">
                                    <input type="radio" id="farm1" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 20</span>
                                </label>
                            </li>
                            <li class="bm10">
                                <label for="farm2" class="custom_radio">
                                    <input type="radio" id="farm2" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 30</span>
                                </label>
                            </li>
                            <li class="bm10">
                                <label for="farm3" class="custom_radio">
                                    <input type="radio" id="farm3" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 50</span>
                                </label>
                            </li>
                            <li class="bm10">
                                <label for="farm4" class="custom_radio">
                                    <input type="radio" id="farm4" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 50</span>
                                </label>
                            </li>
                            <li class="bm10">
                                <label for="farm5" class="custom_radio">
                                    <input type="radio" id="farm5" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 50</span>
                                </label>
                            </li>
                            <li class="bm10">
                                <label for="farm6" class="custom_radio">
                                    <input type="radio" id="farm6" class="appearance dn" name="farm_name">
                                    <span class="radio_box">Smart farm 50</span>
                                </label>
                            </li>
                        </ul>
                    </div>

                    <input type="hidden" name="device_info" value={{device_info.device_serial}}>
                    
                </div>
                <div id = "get_hidden_2" class="get_hidden" style="display:none">

                    <h2 class="top_title re_tp10">Krishian smart farm details</h2>
                    <ul class="form_ul tm50 tx_l">
                        <li>
                            <p class="input_tit">Farm model No</p>
                            <div class="input_box">
                                <input type="text" placeholder="" name="farm_no">
                            </div>
                        </li>
                        <li>
                            <p class="input_tit">Farm capacity</p>
                            <div class="input_box plants_box">
                                <input type="text" placeholder="" name="farm_capacity">
                                <span class="txt_gray66 txt_14">Plants</span>
                            </div>
                        </li>
                        <li>
                            <p class="input_tit">Farm type</p>
                            <div class="input_box">
                                <input type="text" placeholder="" name="farm_type">
                            </div>
                        </li>
                    </ul>
                    
                </div>

                <a href="#" id ="shownextform" class="next_btn tm100 re_tm10">nextui</a>
                <button id = "tmp_store" style="display: none;" class="next_btn tm100 re_tm10"> Next</button>
                
                
                
            </div>
        </form>
    </div>
    <script type="text/javascript">
        window.onload = function(){
            var butt = document.getElementById("tmp_store");

            var next_div = butt.parent;
            butt.addEventListener('click', function(){
                var inputs = document.querySelectorAll("input");
                var device_info_hidden = document.querySelector("input[name='device_serial']").value;
                var parent;
                var checked_farm_name;
                for (var i=0; i<inputs.length; i++){
                    if (inputs[i].checked === true){
                        parent = inputs[i].parentNode;
                        checked_farm_name = parent.children[1].innerText;
                    }
                    
                }
                console.log(checked_farm_name);
                //var device_info = document.getElementsByName('device_info').values;
                //console.log(device_info);
                sessionStorage.setItem("device_info", device_info_hidden);
                sessionStorage.setItem("farm_name", checked_farm_name);

        
            }); //do not use session storage?

            var shownextform = document.getElementById("shownextform");
            let last_ui = 0;
            
            shownextform.addEventListener('click', function(){
                var nextui_list = document.querySelectorAll(".get_hidden");
                for (let i=0; i<nextui_list.length; i++){
                    console.log(nextui_list[i].id);
                    if (nextui_list[i].style.display == "block"){
                        if (i < nextui_list.length-1){
                            nextui_list[i].style.display = "none";
                            nextui_list[i+1].style.display = "block";
                            last_ui += 1;
                        }
                        if (nextui_list[i].id == "get_hidden_1"){ //why get_hidden_1? because it's onclick event, so when get_hidden_2 appeared,it still not work until it's clicked
                            document.getElementById("tmp_store").style.display = "block";
                            shownextform.style.display = "none";
                        }
                        break;
                    }

                }
            });
        }
        </script>
    <!-- //device -->
    <!-- footer_gnb -->
    <footer class="footer_gnb">
        <ul class="gnb_ul">
            <li>
                <a href="#"><img src={% static "images/ic_store.png" %} alt="store icon"></a>
            </li>
            <li>
                <a href="#"><img src={% static "images/ic_community.png" %} alt="community icon"></a>
            </li>
        </ul>
        <a href="javascript:;" class="gnb_home"><img src={% static "images/ic_home.png" %} alt="home icon"></a>
    </footer>
    <!-- //footer_gnb -->
</body>
</html>